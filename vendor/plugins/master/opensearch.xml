

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <title>maccman's juggernaut_plugin at master &mdash; GitHub</title>
    <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub" />
    <link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub" />

    
      <link href="/stylesheets/bundle.css?94755085b6332e8be7e359da7e64829ce8ca73d5" media="screen" rel="stylesheet" type="text/css" />
    

    
      
        <script src="/javascripts/bundle.js?94755085b6332e8be7e359da7e64829ce8ca73d5" type="text/javascript"></script>
      
    
    
  
    
  

  <link href="http://github.com/feeds/maccman/commits/juggernaut_plugin/master" rel="alternate" title="Recent Commits to juggernaut_plugin:master" type="application/atom+xml" />


    
  </head>

  

  <body>
    

    <div id="main">
      <div id="header" class="">
        <div class="site">
          <div class="logo">
            <a href="/"><img src="/images/modules/header/logo.png" alt="git-hub" /></a>
          </div>
          
            <div class="actions">
              <a href="/">Home</a>
              <a href="/plans"><b><u>Pricing and Signup</u></b></a>
              <a href="/repositories">Repositories</a>
              <a href="/blog">Blog</a>
              <a href="/login">Login</a>
            </div>
          
        </div>
      </div>
      
      
        
  <div id="repo_menu">
    <div class="site">
      <ul>
        
          <li class="active"><a href="/maccman/juggernaut_plugin/tree/master">Source</a></li>

          <li class=""><a href="/maccman/juggernaut_plugin/commits/master">Commits</a></li>

          <li class=""><a href="/maccman/juggernaut_plugin/graphs">Graphs</a></li>

          <li class=""><a href="/maccman/juggernaut_plugin/wikis">Wiki (1)</a></li>

          <li class=""><a href="/maccman/juggernaut_plugin/watchers">Watchers (22)</a></li>

          <li class=""><a href="/maccman/juggernaut_plugin/network">Network (5)</a></li>

          

        
      </ul>
    </div>
  </div>

  <div id="repo_sub_menu">
    <div class="site">
      <div class="joiner"></div>
      

      

      
        <ul>
          <li>
            <a class="active" href="/maccman/juggernaut_plugin/tree/23d074b94bffc4d7826e6afdc4c74d11d2b91219">master</a>
          </li>
          <li>
            <a href="#">all branches</a>
            <ul>
              
                <li><a href="/maccman/juggernaut_plugin/tree/master">master</a></li>
              
            </ul>
          </li>
          <li>
            <a href="#">all tags</a>
            
          </li>
        </ul>

      
    </div>
  </div>

  <div class="site">
    



<div id="repos">
  


<div class="repo public">
  <div class="title">
    <div class="path">
      <a href="/maccman">maccman</a> / <b><a href="/maccman/juggernaut_plugin/tree">juggernaut_plugin</a></b>

      

        

        
          

          
            
            <a href="/signup"><img alt="fork" class="button" src="/images/modules/repos/fork_button.png?94755085b6332e8be7e359da7e64829ce8ca73d5" /></a> 
          
        

        <a href="/signup" class="toggle_watch"><img alt="watch" class="button" src="/images/modules/repos/watch_button.png?94755085b6332e8be7e359da7e64829ce8ca73d5" /></a><a href="/signup" class="toggle_watch" style="display:none;"><img alt="watch" class="button" src="/images/modules/repos/unwatch_button.png?94755085b6332e8be7e359da7e64829ce8ca73d5" /></a>

        
          <a href="#" id="download_button" rel="/maccman/juggernaut_plugin/downloads/master"><img alt="download tarball" class="button" src="/images/modules/repos/download_button.png?94755085b6332e8be7e359da7e64829ce8ca73d5" /></a> 
        
      
    </div>

    <div class="security private_security" style="display:none">
      <a href="#private_repo" rel="facebox"><img src="/images/icons/private.png" alt="private" /></a>
    </div>

    <div id="private_repo" class="hidden">
      This repository is private.  
      All pages are served over SSL and all pushing and pulling is done over SSH.
      No one may fork, clone, or view it unless they are added as a <a href="/maccman/juggernaut_plugin/edit/collaborators">member</a>.

      <br/>
      <br/>
      Every repository with this icon (<img src="/images/icons/private.png" alt="private" />) is private.
    </div>

    <div class="security public_security" style="">
      <a href="#public_repo" rel="facebox"><img src="/images/icons/public.png" alt="public" /></a>
    </div>

    <div id="public_repo" class="hidden">
      This repository is public.
      Anyone may fork, clone, or view it.

      <br/>
      <br/>
      Every repository with this icon (<img src="/images/icons/public.png" alt="public" />) is public.
    </div>

    
  </div>
  <div class="meta">
    <table>
      
      
        <tr>
          <td class="label">Description:</td>
          <td>
            <span id="repository_description" rel="/maccman/juggernaut_plugin/edit/update" class="">Realtime Rails</span> 
            
          </td>
        </tr>
      

      
        
          <tr>
            <td class="label">Homepage:</td>
            <td>
              
                
                <a href="http://juggernaut.rubyforge.org">http://juggernaut.rubyforge.org</a> 
              
            </td>
          </tr>
        
        
          <tr>
            <td class="label">Clone&nbsp;URL:</td>
            
            <td>
              <a href="git://github.com/maccman/juggernaut_plugin.git" class="git_url_facebox" rel="#git-clone">git://github.com/maccman/juggernaut_plugin.git</a>
              <div id="git-clone" style="display:none;">
                Give this clone URL to anyone.
                <br/>
                <code>git clone git://github.com/maccman/juggernaut_plugin.git </code>
              </div>
            </td>
          </tr>
        
        
        
        
      
    </table>
    
      </div>
</div>

</div>

<div id="commit">
  <div class="group">
    <div class="envelope commit">
  <div class="human">
    
      <div class="message"><pre><a href="/maccman/juggernaut_plugin/commit/23d074b94bffc4d7826e6afdc4c74d11d2b91219">Register JavaScript expansion properly</a> </pre></div>
    

    <div class="actor">
      <div class="gravatar">
        
        <img alt="" height="30" src="http://www.gravatar.com/avatar/baf018e2cc4616e4776d323215c7136c?s=30&amp;d=http%3A%2F%2Fgithub.com%2Fimages%2Fgravatars%2Fgravatar-30.png" width="30" />
      </div>
      <div class="name"><a href="/maccman">maccman</a> <span>(author)</span></div>
        <div class="date">
          <abbr class="relatize" title="2008-10-27 06:06:37">Mon Oct 27 06:06:37 -0700 2008</abbr> 
        </div>
    </div>

    

  </div>
  <div class="machine">
    <span>c</span>ommit&nbsp;&nbsp;<a href="/maccman/juggernaut_plugin/commit/23d074b94bffc4d7826e6afdc4c74d11d2b91219" hotkey="c">23d074b94bffc4d7826e6afdc4c74d11d2b91219</a><br />
    <span>t</span>ree&nbsp;&nbsp;&nbsp;&nbsp;<a href="/maccman/juggernaut_plugin/tree/23d074b94bffc4d7826e6afdc4c74d11d2b91219" hotkey="t">7fa72722331cbb876d52fb6334457075ed78d511</a><br />

    
      <span>p</span>arent&nbsp;
      
      <a href="/maccman/juggernaut_plugin/tree/00dc5a4d6451664b3a223a90ca8ce5ea23ebdd5d" hotkey="p">00dc5a4d6451664b3a223a90ca8ce5ea23ebdd5d</a>
    

  </div>
</div>

  </div>
</div>



  
    <div id="path">
      <b><a href="/maccman/juggernaut_plugin/tree">juggernaut_plugin</a></b> / 
    </div>

    
      
<div id="browser"> 
  <table cellpadding="0" cellspacing="0">
    <tr>
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>
        <div class="history">
          <a href="/maccman/juggernaut_plugin/commits/master/">history</a>
        </div>
        message
      </th>
    </tr>

    

    
      <tr class="alt">
        <td class="icon"> <img alt="file" src="/images/icons/txt.png?94755085b6332e8be7e359da7e64829ce8ca73d5" /> </td>
        <td> <a href="/maccman/juggernaut_plugin/tree/master/LICENSE">LICENSE</a> </td>
        <td> <span class="relatize">Sun Aug 31 02:03:52 -0700 2008</span> </td>
        <td> <a href="/maccman/juggernaut_plugin/commit/a4e0c01d824326573c18599275add10884bbcfac" class="message">first commit</a> [<a href="/maccman">maccman</a>] </td>
      </tr>
    
      <tr class="">
        <td class="icon"> <img alt="file" src="/images/icons/txt.png?94755085b6332e8be7e359da7e64829ce8ca73d5" /> </td>
        <td> <a href="/maccman/juggernaut_plugin/tree/master/README">README</a> </td>
        <td> <span class="relatize">Tue Sep 02 00:03:23 -0700 2008</span> </td>
        <td> <a href="/maccman/juggernaut_plugin/commit/948b2abe7faade2e0797ced1aa0147defc65e5f3" class="message">Sync with SVN (we'll do a better job at this in...</a> [<a href="/maccman">maccman</a>] </td>
      </tr>
    
      <tr class="alt">
        <td class="icon"> <img alt="file" src="/images/icons/txt.png?94755085b6332e8be7e359da7e64829ce8ca73d5" /> </td>
        <td> <a href="/maccman/juggernaut_plugin/tree/master/init.rb">init.rb</a> </td>
        <td> <span class="relatize">Mon Oct 27 06:06:37 -0700 2008</span> </td>
        <td> <a href="/maccman/juggernaut_plugin/commit/23d074b94bffc4d7826e6afdc4c74d11d2b91219" class="message">Register JavaScript expansion properly</a> [<a href="/maccman">maccman</a>] </td>
      </tr>
    
      <tr class="">
        <td class="icon"> <img alt="file" src="/images/icons/txt.png?94755085b6332e8be7e359da7e64829ce8ca73d5" /> </td>
        <td> <a href="/maccman/juggernaut_plugin/tree/master/install.rb">install.rb</a> </td>
        <td> <span class="relatize">Sun Aug 31 02:03:52 -0700 2008</span> </td>
        <td> <a href="/maccman/juggernaut_plugin/commit/a4e0c01d824326573c18599275add10884bbcfac" class="message">first commit</a> [<a href="/maccman">maccman</a>] </td>
      </tr>
    
      <tr class="alt">
        <td class="icon"> <img alt="directory" src="/images/icons/dir.png?94755085b6332e8be7e359da7e64829ce8ca73d5" /> </td>
        <td> <a href="/maccman/juggernaut_plugin/tree/master/lib">lib/</a> </td>
        <td> <span class="relatize">Mon Oct 27 06:06:37 -0700 2008</span> </td>
        <td> <a href="/maccman/juggernaut_plugin/commit/23d074b94bffc4d7826e6afdc4c74d11d2b91219" class="message">Register JavaScript expansion properly</a> [<a href="/maccman">maccman</a>] </td>
      </tr>
    
      <tr class="">
        <td class="icon"> <img alt="directory" src="/images/icons/dir.png?94755085b6332e8be7e359da7e64829ce8ca73d5" /> </td>
        <td> <a href="/maccman/juggernaut_plugin/tree/master/media">media/</a> </td>
        <td> <span class="relatize">Wed Sep 03 01:07:46 -0700 2008</span> </td>
        <td> <a href="/maccman/juggernaut_plugin/commit/00dc5a4d6451664b3a223a90ca8ce5ea23ebdd5d" class="message">add console for Safari (rather than alerts)</a> [<a href="/maccman">maccman</a>] </td>
      </tr>
    
      <tr class="alt">
        <td class="icon"> <img alt="directory" src="/images/icons/dir.png?94755085b6332e8be7e359da7e64829ce8ca73d5" /> </td>
        <td> <a href="/maccman/juggernaut_plugin/tree/master/tasks">tasks/</a> </td>
        <td> <span class="relatize">Sun Aug 31 02:05:50 -0700 2008</span> </td>
        <td> <a href="/maccman/juggernaut_plugin/commit/408da887346f2e5bb0215386fb1ff08b22c0935b" class="message">Remove svn</a> [<a href="/maccman">maccman</a>] </td>
      </tr>
    
  </table>
</div>

<div id="readme"><span class="name">README</span><div class="plain"><pre>Juggernaut
===========

=CONTACT DETAILS

  Author: Alex MacCaw
  E-Mail Address: <a href="mailto:info@alexmaccaw.co.uk">info@alexmaccaw.co.uk</a>
  License: MIT
  Website: <a href="http://juggernaut.rubyforge.org">http://juggernaut.rubyforge.org</a>
  Blog: <a href="http://www.eribium.org">http://www.eribium.org</a>

=DESCRIPTION

The Juggernaut plugin for Ruby on Rails aims to revolutionize your Rails app by letting the server initiate a connection 
and push data to the client. In other words your app can have a real time connection to the server with the advantage of 
instant updates. Although the obvious use of this is for chat, the most exciting prospect for me is collaborative cms 
and wikis.

What Happens:

   1. Client A opens socket connection to the socket server
   2. Client B makes Ajax call to Rails
   3. Rails sends message to the socket server
   4. Socket server broadcasts message to clients

Juggernaut Features:

    * Allows a real time connection with a client - Rails can literally push javascript in real time to the client which 
    is then evaluated.
    * Push server - written in Ruby.
    * Integrated, as a plugin, into Rails.
    * Subscribers can subscribe to multiple channels, and broadcasters can broadcast to multiple channels.
    * Subscribers can provide a 'unique_id' and broadcasters can send data to specific clients.
    * Add and remove channels at runtime
    * Uses Flash 8 - installed on more than 98% of computers.
    * Supports all the major browsers (uses ExternalInterface): Firefox 1+, IE 6+ and Safari 2+.

Requirements:

    * Rails 2.0.2 or edge
    * json gem (gem install json)
    * EventMachine gem (gem install eventmachine)
    * juggernaut gem (gem install juggernaut)


===============================================
INSTALLATION
===============================================

   1. From your Rails Dir:
      script/plugin install <a href="http://juggernaut.rubyforge.org/svn/trunk/juggernaut">http://juggernaut.rubyforge.org/svn/trunk/juggernaut</a>
   2. Make sure to include the appropriate JavaScripts in your views/layouts
      in the header of your views
      &lt;%= javascript_include_tag 'prototype', :juggernaut %&gt;
   3. Add this to your view/layout head:
      &lt;%= juggernaut %&gt;
   4. Make sure the juggernaut gem is installed (gem install juggernaut) and run:
      juggernaut -g juggernaut.yml
      juggernaut -c juggernaut.yml
   5. Run script/server and visit the Jugged up page.
   6. Then, to send data to juggernaut, execute this in the console:
      Juggernaut.send_to_all(&quot;alert('hi from juggernaut')&quot;)

Usage

To demonstrate Juggernaut I'll walk you through building a simple chat.

Start the push server going by running:
juggernaut -g juggernaut.yml
juggernaut -c juggernaut.yml

The chat controller:

class ChatController &lt; ApplicationController
  def index
  end
  
  def send_data
    render :juggernaut do |page|
      page.insert_html :top, 'chat_data', &quot;&lt;li&gt;#{h params[:chat_input]}&lt;/li&gt;&quot;
    end
    render :nothing =&gt; true
  end
end


The index.html.erb

  &lt;html&gt;
    &lt;head&gt;
      &lt;%= javascript_include_tag :defaults, :juggernaut %&gt;
      &lt;%= juggernaut %&gt;
    &lt;/head&gt;
    &lt;body&gt;
      &lt;%= form_remote_tag(
            :url =&gt; { :action =&gt; :send_data },
            :complete =&gt; &quot;$('chat_input').value = ''&quot; ) %&gt;
        &lt;%= text_field_tag( 'chat_input', '', { :size =&gt; 20, :id =&gt; 'chat_input'} ) %&gt;
        &lt;%= submit_tag &quot;Add&quot; %&gt;
      &lt;/form&gt;
      &lt;ul id=&quot;chat_data&quot; style=&quot;list-style:none&quot;&gt;
      &lt;/ul&gt;
    &lt;/body&gt;
  &lt;/html&gt;

Start the webserver going with:
ruby script/server

Try it and see what you think. If it doesn't work please visit the faq.

Other ways of rendering to juggernaut:

render :juggernaut do |page|
  page.alert('hi')
end

render_juggernaut(:action =&gt; 'whatever')

===============================================
More usage information, examples and support
===============================================

=== Channel Usage ===

&lt;%= juggernaut(:channels =&gt; ['one', 'two', 'three']) %&gt;
render :juggernaut =&gt; {:type =&gt; :send_to_channels, :channels =&gt; ['one']} do |page|
  page.alert('hi')
end

Client id usage:
&lt;%= juggernaut(:client_id =&gt; session[:user_id]) %&gt;
render :juggernaut =&gt; {:type =&gt; :send_to_clients, :client_ids =&gt; [1, 2, 3]} do |page|
  page.alert('hi')
end

Other juggernaut render options:
OPTION_TYPE                     PARAMS
:send_to_all                  
:send_to_channels               :channels
:send_to_channel                :channel
:send_to_client                 :client_id
:send_to_clients                :client_ids
:send_to_client_on_channel      :client_id,  :channel
:send_to_clients_on_channel     :client_ids, :channel
:send_to_client_on_channels     :client_id, :channels
:send_to_clients_on_channels    :client_ids, :channels

You can also call these methods directly on the Juggernaut class:
Juggernaut.send_to_clients('data', [1,2,3])

For authentication options and callbacks see the juggernaut.yml configuration file.

Usage and examples: <a href="http://ncavig.com/blog/">http://ncavig.com/blog/</a>
Support and forums: <a href="http://groups.google.com/group/Juggernaut-for-Rails?hl=en">http://groups.google.com/group/Juggernaut-for-Rails?hl=en</a>

=== Getting remote clients to connect ===

Firstly you will need to configure juggernaut_hosts.yml in your Rails app to point to the proper IP of the push server 
(rather than 127.0.0.1).
For example:
:hosts:
  - :port: 5001
    :host: 129.168.0.2
    :environment: :production

Ok, remote clients that visit pages on this server (once you restart it) will connect to the proper push server IP. BUT, 
if you're using IP based
authentication (recommended) you'll find that the broadcast authentication fails.
You'll need to add the Rails IP to juggernaut.yml, like so:

:allowed_ips: 
        - 127.0.0.1
        - 192.168.0.4 # IP of the Rails app

===============================================
Jquery
===============================================

To get Juggernaut working with Jquery (Prototype is used by default) follow the tutorial above with the following 
differences.

&gt;&gt;Javascripts

  You must have jquery.js (version 1.2.6 tested) and the jquery-json plugin 
  (<a href="http://www.jdempster.com/wp-content/uploads/2007/08/jquery.json.js">http://www.jdempster.com/wp-content/uploads/2007/08/jquery.json.js</a>) in the /javascripts directory. 

  You need the jquerynaut.js file in the /javascripts/juggernaut directory (found in /lib in the media directory)


&gt;&gt;The chat controller:

  class ChatController &lt; ApplicationController
    def index
    end
  
    def send_data
      render :juggernaut do |page|
        page[&quot;#chat_data&quot;].prepend &quot;&lt;li&gt;#{h params[:chat_input]}&lt;/li&gt;&quot;
      end
      render :nothing =&gt; true
    end

  end


&gt;&gt;The index.html.erb

  &lt;html&gt;
    &lt;head&gt;
      &lt;%= javascript_include_tag 'jquery', 'json', 'juggernaut/juggernaut', 'juggernaut/jquerynaut', 
      'juggernaut/swfobject'  %&gt;
      &lt;%= juggernaut %&gt;
    &lt;/head&gt;
    &lt;body&gt;
      &lt;form action=&quot;/chat/send_data&quot; method=&quot;get&quot;&gt;
        &lt;div style=&quot;margin:0;padding:0&quot;&gt;
        &lt;input id=&quot;chat_input&quot; name=&quot;chat_input&quot; size=&quot;20&quot; type=&quot;text&quot; value=&quot;&quot; /&gt;
        &lt;input name=&quot;commit&quot; type=&quot;submit&quot; value=&quot;Add&quot; /&gt;
      &lt;/form&gt;

      &lt;script&gt;
      $(document).ready(function(){
        $('form').submit(function(){
          $.get('/chat/send_data', { chat_input: $('#chat_input').val() } )
          return false;
        })
      })
      &lt;/script&gt;
      &lt;ul id=&quot;chat_data&quot; style=&quot;list-style:none&quot;&gt;&lt;/ul&gt;
    &lt;/body&gt;
  &lt;/html&gt;



===============================================
Troubleshooting
===============================================

Check out the support forums on google groups:
<a href="http://groups.google.com/group/Juggernaut-for-Rails">http://groups.google.com/group/Juggernaut-for-Rails</a>


</pre></div></div>

    
  


  </div>

      
      
      <div class="push"></div>
    </div>
    
    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">T-Shirts</a> |            
            <a href="/blog">Blog</a> |             
            <a href="http://groups.google.com/group/github/">Google Group</a> | 
            <a href="http://logicalawesome.lighthouseapp.com/projects/8570/home">Bugs &amp; Features</a> |
            <a href="/training">Git Training</a> | 
            <a href="mailto:support@github.com">Contact</a> |
            <a href="http://github.wordpress.com">Status</a> 
          </div>
          <div class="company">
            <span id="_rrt" title="0.19124s from github.com">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> | &copy;2008 | <a href="/site/terms">Terms of Service</a> | <a href="/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com">Hosting provided by</a>&nbsp;
          <a href="http://engineyard.com">
            <img src="/images/modules/footer/engine_yard_logo.gif" alt="Hosted by Engine Yard" />
          </a>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display:none;">
      This feature is coming soon.  Sit tight!
    </div>
        <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    var pageTracker = _gat._getTracker("UA-3769691-2");
    pageTracker._initData();
    pageTracker._trackPageview();
    </script>

  </body>
</html>

